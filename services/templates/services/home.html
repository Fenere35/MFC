{% extends "services/base.html" %}

{% block title %}Главная - МФЦ-Онлайн{% endblock %}

{% block content %}
<div class="container">
    <h1>Добро пожаловать в МФЦ-Онлайн!</h1>
    
    <!-- Форма поиска на главной -->
    <form method="get" action="{% url 'services:search' %}" style="margin: 30px 0;">
        <div style="display: flex; gap: 10px; max-width: 600px; margin: 0 auto;">
            <input type="text" name="q" placeholder="Поиск услуг, офисов, новостей..." 
                   style="flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 1rem;">
            <button type="submit" style="padding: 12px 24px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">
                Найти
            </button>
        </div>
    </form>
    
    <p>Текущий пользователь: 
        {% if user.is_authenticated %}
            {{ user.username }}
        {% else %}
            Гость
        {% endif %}
    </p>
    
    <div class="stats">
        <h2>Статистика системы</h2>
        <p>Всего услуг в системе: {{ stats.total_services|default:"0" }}</p>
        <p>Всего офисов МФЦ: {{ stats.total_offices|default:"0" }}</p>
    </div>
    
    <div class="simple-widgets">
        <div class="widget">
            <h3>Быстрые ссылки</h3>
            <ul>
                <li><a href="{% url 'services:service_list' %}">Все услуги</a></li>
                <li><a href="{% url 'services:office_list' %}">Наши офисы</a></li>
                <li><a href="{% url 'services:news_list' %}">Новости</a></li>
                <li><a href="{% url 'services:search' %}">Поиск</a></li>
            </ul>
        </div>
    </div>

    
    <div class="widget">
        <h3>Последние новости</h3>
        {% for news in latest_news %}
            <div style="border-bottom: 1px solid #eee; padding: 10px 0;">
                <strong>{{ news.title }}</strong>
                <p>{{ news.published_at|date:"d.m.Y" }}</p>
                <p>{{ news.content|truncatewords:20 }}</p>
            </div>
        {% empty %}
            <p>Новостей пока нет</p>
        {% endfor %}
    </div>

    <div class="widget">
        <h3>Популярные услуги</h3>
        {% for service in popular_services %}
            <div style="border-bottom: 1px solid #eee; padding: 10px 0;">
                <strong>{{ service.name }}</strong>
                <p>Категория: {{ service.category.name }}</p>
                <p>Заявлений: {{ service.application_count }}</p>
            </div>
        {% empty %}
            <p>Услуг пока нет</p>
        {% endfor %}
    </div>

</div>

<style>
.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}
.stats {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    margin: 20px 0;
}
.widget {
    background: white;
    border: 1px solid #ddd;
    padding: 15px;
    border-radius: 5px;
    margin: 10px 0;
}
</style>
{% endblock %}